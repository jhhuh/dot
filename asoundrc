pcm.mpow {
    type bluealsa
    interface "hci0"
    profile "a2dp"
    delay 0
    device "00:08:2A:F0:0A:FF"
}

ctl.mpow {
    type bluealsa
    interface "hci0"
}

#pcm.dmixer {
#  type dmix
#  ipc_key 1024 # must be unique!
#  slave {
#    pcm mpow
#  } 
#}
#
#pcm.!default {
#  type plug
#  slave.pcm dmixer
#}
#
#
#
#pcm.ossmix {
#    type dmix
#    ipc_key 1024 # must be unique!
##   ipc_key_add_uid false   # let multiple users share
##   ipc_perm 0666           # IPC permissions for multi-user sharing (octal, default 0600)
#    slave {
#        pcm "hw:0,0"      # you cannot use a "plug" device here, darn.
#        period_time 0
#        period_size 1024 # must be power of 2
#        buffer_size 8192  # dito. It
#       #format "S32_LE"
#       #periods 128 # dito.
#       #rate 8000 # with rate 8000 you *will* hear,
#       # if ossmix is used :)
#    }
#    # bindings are cool. This says, that only the first
#    # two channels are to be used by dmix, which is
#    # enough for (most) oss apps and also lets 
#    # multichannel chios work much faster:
#    bindings {
#        0 0 # from 0 => to 0
#        1 1 # from 1 => to 1
#    }
#}


# BlueALSA integration setup


pcm_type.bluealsa {
    libs.native "/home/jhhuh/.nix-profile/lib/alsa-lib/libasound_module_pcm_bluealsa.so"
}

ctl_type.bluealsa {
    libs.native "/home/jhhuh/.nix-profile/lib/alsa-lib/libasound_module_ctl_bluealsa.so"
}

ctl.bluealsa {
	@args [ HCI ]
	@args.HCI {
		type string
		default {
			@func refer
			name defaults.bluealsa.interface
		}
	}
	type bluealsa
	interface $HCI
}

pcm.bluealsa {
	@args [ HCI DEVICE PROFILE DELAY ]
	@args.HCI {
		type string
		default {
			@func refer
			name defaults.bluealsa.interface
		}
	}
	@args.DEVICE {
		type string
		default {
			@func refer
			name defaults.bluealsa.device
		}
	}
	@args.PROFILE {
		type string
		default {
			@func refer
			name defaults.bluealsa.profile
		}
	}
	@args.DELAY {
		type integer
		default {
			@func refer
			name defaults.bluealsa.delay
		}
	}
	type plug
	slave.pcm {
		type bluealsa
		interface $HCI
		device $DEVICE
		profile $PROFILE
		delay $DELAY
	}
	hint {
		show {
			@func refer
			name defaults.namehint.extended
		}
		description "Bluetooth Audio Hub"
	}
}

